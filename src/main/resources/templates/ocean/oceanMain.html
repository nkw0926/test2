<!DOCTYPE html>
<html lang="en">
<head th:replace="~{/include/header :: header}">
</head>
<body>
<div id="body-wrapper" style="height: 100vh">
    <div id="body-content" style="height: auto; min-height: 100%; padding-bottom: 90px">
<div th:replace="~{/include/body-header :: bodyHeader}"></div>
<div id="pad">
<main id="main">
    <section class="section site-portfolio" >
        <div class="container" >
            <div class="row mb-5 align-items-center">
                <div class="col-md-12 col-lg-6 mb-4 mb-lg-0" data-aos="fade-up">
                    <h2 th:text="'Hi '+ ${loginUserName}"></h2>
                    <p class="mb-0" style="padding-bottom: 20px">당신의 물고기를 낚아보세요! 🐠 </p>
                </div>
                <!--                <form id="selectConditionMapForm" action="#" method="post">-->
                <div class="container">
                    <div class="row">
                        <div class="col">
                            <select class="form-select btn btn-outline-primary" id="location"
                                    data-style="btn-primary" multiple
                                    title='지역'>
                                <option value="서울">서울</option>
                                <option value="경기">경기</option>
                                <option value="강원">강원</option>
                                <option value="충북">충북</option>
                                <option value="충남">충남</option>
                                <option value="전북">전북</option>
                                <option value="전남">전남</option>
                                <option value="경북">경북</option>
                                <option value="경남">경남</option>
                                <option value="제주">제주</option>
                            </select>

                        </div>

                        <div class="col">
                            <select class="form-select btn btn-outline-success" data-style="btn-success" multiple
                                    id="age" title='나이'>
                                <option value="20,21,22,23,24">20~24 age</option>
                                <option value="25,26,27,28,29">25~29 age</option>
                                <option value="30,31,32,33,34">30~34 age</option>
                                <option value="35,36,37,38,39">35~39 age</option>
                            </select>
                        </div>
                        <div class="col">
                            <select class="form-select btn btn-outline-danger" data-style="btn-danger" multiple
                                    id="hobby" title='취미'>
                                <option value="운동">운동</option>
                                <option value="독서">독서</option>
                                <option value="산책">산책</option>
                                <option value="음악감상">음악감상</option>
                                <option value="영화/드라마감상">영화/드라마감상</option>
                                <option value="노래부르기">노래부르기</option>
                                <option value="춤추기">춤추기</option>
                                <option value="공예/만들기">공예/만들기</option>
                                <option value="맛집탐방">맛집탐방</option>
                            </select>
                        </div>
                        <div class="col">
                            <select class="form-select btn btn-outline-dark"
                                    style="color: #fd7e14; border-color: #fd7e14" data-style="btn-dark" multiple
                                    id="personality" title='성격'>
                                <option value="다정다감">다정다감</option>
                                <option value="참을성만땅">참을성만땅</option>
                                <option value="애교쟁이">애교쟁이</option>
                                <option value="예의바른">예의바른</option>
                                <option value="소심소심">소심소심</option>
                                <option value="이끌어가는">이끌어가는</option>
                                <option value="감성폭발">감성폭발</option>
                                <option value="똑똑이">똑똑이</option>
                                <option value="입답천재">입답천재</option>
                                <option value="긍정에너지">긍정에너지</option>
                                <option value="인싸그잡채">인싸그잡채</option>
                            </select>
                        </div>
                        <div class="col">
                            <button id="submitButton" class="btn btn-warning " onclick="getCheckboxValue()">조회</button>
                        </div>
                    </div>
                </div>
                <!--                </form>-->

            </div>
            <div id="zeroContainer">
            </div>
            <div id="portfolio-grid" class="row no-gutter userList" data-aos="fade-up" data-aos-delay="200" style="height: 100vh !important;">

                <div class="item web col-sm-6 col-md-4 col-lg-4 mb-4" th:each="list : ${userList}">
                    <a th:href="@{/ocean/userDetail(userId=${list.userId})}" class="item-wrap fancybox">
                        <div class="work-info">
                            <h3 th:text="${list.userName}"></h3>
                            <h3 th:text="${list.userJob}"></h3>
                            <h3 th:text="${list.userAge} + ' age'"></h3>
                            <h3 th:text="${list.userSex}"></h3>
                            <h3 th:text="${list.userAddress}"></h3>
                        </div>

                        <img class="img-fluid"
                             th:src="@{assets/img/userImg/} + ${list.userEmail} + @{/} + ${list.userEmail} +@{_1.jpg}" style="width: 400px; height: 400px; box-shadow: 5px 5px 5px 5px rgba(199, 199, 199, 0.88); border-radius: 15px;">
                        <!--                        <img class="img-fluid" th:src="@{assets/img/userImg/1/1_1.jpg}" >-->
                    </a>
                </div>
            </div>
        </div>
    </section>

</main>
</div>

    </div>

</div>
<!--<script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>-->
<!--<script src="https://code.jquery.com/jquery-3.4.1.js"></script>-->
<script src="assets/vendor/aos/aos.js"></script>

<script src="assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
<script src="assets/vendor/swiper/swiper-bundle.min.js"></script>
<script src="assets/vendor/php-email-form/validate.js"></script>
<script src="assets/js/main.js"></script>

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.1/dist/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<!-- 부트스트랩 JavaScript 및 종속성 -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<!-- 부트스트랩 JavaScript -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        crossorigin="anonymous"></script>
<!-- Latest compiled and minified JavaScript -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.14.0-beta3/dist/js/bootstrap-select.min.js"></script>

<!-- (Optional) Latest compiled and minified JavaScript translation files -->
<!--<script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.14.0-beta3/dist/js/i18n/defaults-*.min.js"></script>-->
<script th:inline="javascript">
    $('select').selectpicker();

    function getCheckboxValue() {
        const location = document.getElementById('location');
        const locations = location.selectedOptions;
        const locationList = [];

        for (let i = 0; i < locations.length; i++) {
            locationList.push(locations[i].value);
        }

        const age = document.getElementById('age');
        const ages = age.selectedOptions;
        const ageList = [];

        for (let i = 0; i < ages.length; i++) {
            ageList.push(ages[i].value);
        }

        const hobby = document.getElementById('hobby');
        const hobbies = hobby.selectedOptions;
        const hobbyList = [];

        for (let i = 0; i < hobbies.length; i++) {
            hobbyList.push(hobbies[i].value);
        }

        const personality = document.getElementById('personality');
        const personalities = personality.selectedOptions;
        const personalityList = [];

        for (let i = 0; i < personalities.length; i++) {
            personalityList.push(personalities[i].value);
        }


        const selectCondotionMap = {
            locationList: locationList,
            ageList: ageList,
            hobbyList: hobbyList,
            personalityList: personalityList
        };
        $.ajax({
            type: "POST",
            url: "/ocean/selectCondition",
            data: JSON.stringify(selectCondotionMap),
            contentType: "application/json",
            success: function (response) {
                processResponseData(response);
            },
            error: function (error) {
                alert("error");
            },
        });
    }

    function processResponseData(response) {
        console.log("response");
        console.log(response.length);

        // 결과를 보여줄 컨테이너 요소 선택
        const userListContainer = document.getElementById("portfolio-grid");

        // userListContainer의 내용 초기화
        userListContainer.innerHTML = "";
        // userList를 순회하며 표시할 부분을 추가
        response.forEach(list => {
            const userItem = `
            <div class="item web col-sm-6 col-md-4 col-lg-4 mb-4">
                <a href="/ocean/userDetail?userId=${list.userId}" class="item-wrap fancybox">
                    <div class="work-info">
                        <h3>${list.userName}</h3>
                        <h3>${list.userJob}</h3>
                        <h3>${list.userAge}</h3>
                        <h3>${list.userSex}</h3>
                        <h3>${list.userAddress}</h3>

                    </div>
                    <img class="img-fluid" src="assets/img/userImg/${list.userEmail}/${list.userEmail}_1.jpg" style="width: 400px; height: 400px">
                </a>
            </div>`;
            // userListContainer에 사용자 정보 추가
            userListContainer.innerHTML += userItem;
        });

        var responseLen = response.length;
        const zeroContainer = document.getElementById("zeroContainer");
        zeroContainer.innerHTML = "";

        if (responseLen == 0) {
            dynamicHTML = `
         <div  class="alert alert-danger mb-4" role="alert">
         <h3>
         조건에 맞는 사용자가 없습니다.
         다른 조건으로 검색해 주세요
         </h3>
         </div>
         `;
        } else {
            dynamicHTML = `

         `;
        }


        zeroContainer.innerHTML += dynamicHTML;
    }
</script>

</body>

</html>
